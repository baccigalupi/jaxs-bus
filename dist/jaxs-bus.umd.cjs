(function(i,o){typeof exports=="object"&&typeof module<"u"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(i=typeof globalThis<"u"?globalThis:i||self,o(i["jaxs-bus"]={}))})(this,function(i){"use strict";var d=Object.defineProperty;var f=(i,o,n)=>o in i?d(i,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[o]=n;var r=(i,o,n)=>(f(i,typeof o!="symbol"?o+"":o,n),n);class o{constructor(){r(this,"lookup");this.lookup={}}add(s,t,e){this.ensureArrayFor(s);const u={listener:t,index:e,matcher:s};return this.lookup[s].push(u),()=>this.remove(u)}remove(s){this.lookup[s.matcher]&&(this.lookup[s.matcher]=this.lookup[s.matcher].reduce((t,e)=>(e!==s&&t.push(e),t),[]))}matches(s){return this.lookup[s]||[]}ensureArrayFor(s){this.lookup[s]||(this.lookup[s]=[])}}class n{constructor(){r(this,"lookup");this.lookup=[]}add(s,t,e){const u={listener:t,index:e,matcher:s};return this.lookup.push(u),()=>this.remove(u)}remove(s){this.lookup=this.lookup.reduce((t,e)=>(e!==s&&t.push(e),t),[])}matches(s){return this.lookup.filter(t=>t.matcher.test(s))}}class c{constructor(){r(this,"options");r(this,"exactSubscriptions");r(this,"fuzzySubscriptions");r(this,"currentIndex");this.options={},this.exactSubscriptions=new o,this.fuzzySubscriptions=new n,this.currentIndex=0}subscribe(s,t){const u=(typeof s=="string"?this.exactSubscriptions:this.fuzzySubscriptions).add(s,t,this.currentIndex);return this.currentIndex+=1,u}publish(s,t){[...this.exactSubscriptions.matches(s),...this.fuzzySubscriptions.matches(s)].sort((u,l)=>u.index-l.index).forEach(u=>{u.listener(t,this.listenerOptions(s))})}addListenerOptions(s){this.options=s}listenerOptions(s){return{eventName:s,...this.options,publish:this.publish.bind(this)}}}const p=()=>new c;i.JaxsBus=c,i.createBus=p,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
